---
title: Use Ipopt
layout: post
guid: urn:uuid:c3e4cc4f-a019-4ef0-97c5-05a54a2746b2
categories:
  - unix
tags:
  - Ipopt
  - Linux
---

> This note shows a successful use of [Ipopt](https://coin-or.github.io/Ipopt/index.html) on Linux.

{% include lib/mathjax.html %}

* TOC
{:toc}


----------------------------------------------
----------------------------------------------


### [Shared Libraries](http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html)

#### Conventions
{:.no_toc}

##### Shared Library Names
{:.no_toc}

Take the example of blas libraries
```
    update-alternatives --display libblas.so
    # link currently points to /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1

    ll /etc/alternatives/libblas.so
    # /etc/alternatives/libblas.so -> /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1
    ll /usr/lib/x86_64-linux-gnu/blas
    # libblas.so -> libblas.so.3.7.1
    # libblas.so.3 -> libblas.so.3.7.1
    # libblas.so.3.7.1
    ll /usr/lib/libblas.so
    # /usr/lib/libblas.so -> /etc/alternatives/libblas.so 
    # libblas.so is installed in /usr/lib
```

- The *soname* has the prefix _lib_, the name of the library, the phrase _.so_, followed by a period and a version number. A fully-qualified soname includes as a prefix the directory it's in, */usr/lib/x86_64-linux-gnu/blas/libblas.so.3* in this case.
- The *real name* contains the actual library code, it adds to the soname a period, a minor number, another period, and the release number (optional). */usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1* in this case.
- The *linker name* is the name that the compiler uses when requesting a library, */usr/lib/libblas.so* in this case.

##### Filesystem Placement
{:.no_toc}

The GNU standards recommend installing by default all libraries in */usr/local/lib* when distributing source code (and all commands should go into */usr/local/bin*).
According to the FHS, most libraries should be installed in */usr/lib*, but libraries required for startup should be in */lib* and libraries that are not part of the system should be in */usr/local/lib*.

There isn't really a conflict between these two documents; the GNU standards recommend the default for developers of source code, while the FHS recommends the default for distributors (who selectively override the source code defaults, usually via the system's package management system).

### [If the libA is installed?](https://www.ostechnix.com/how-to-find-if-a-package-is-installed-or-not-in-linux-and-unix/)

How to check if a library is installed or not even if I don't know the exact name? On Ubuntu, one can use 
```
    # fix library full name
    dpkg --list | grep -i blas
    # ii  libblas-dev:amd64                             3.7.1-4ubuntu1                                  amd64        Basic Linear Algebra Subroutines 3, static library
    # ii  libblas3:amd64                                3.7.1-4ubuntu1                                  amd64        Basic Linear Algebra Reference implementations, shared library
    # ii  libopenblas-base:amd64                        0.2.20+ds-4                                     amd64        Optimized BLAS (linear algebra) library (shared library)

    # show library full info
    dpkg -s libopenblas-base

    # locate the library
    dpkg -L libopenblas-base
```
for example, to check if the BLAS library is installed.

### Manage multiple blas with [update-alternatives](https://damien.clauzel.eu/post/2005/02/12/Tutoriel-pour-update-alternatives)

For example, there are two versions of shared blas libraries in my Ubuntu, as shown above, *libblas-dev* and *libopenblas-base*.
*update-alternatives* can be used to maintain these different realizations of blas.

```
    # To check if libblas.so already exists
    update-alternatives --list libblas.so

    # Install a new alternative for libblas.so
    # update-alternatives --install <link> <name> <path> <priority>
    sudo update-alternatives --install /usr/lib/libblas.so libblas.so /usr/lib/x86_64-linux-gnu/blas/libblas.so 1000
    sudo update-alternatives --install /usr/lib/libblas.so libblas.so /usr/lib/x86_64-linux-gnu/openblas/libblas.so.3 1010

    # show current installed alternatives
    update-alternatives --display libblas.so
    # show in etc
    ls /etc/alternatives | grep libblas

    # change the current link point to lib
    sudo update-alternatives --config libblas.so
    # or switch to the highest priority installed alternatives
    sudo update-alternatives --auto libblas.so

    # remove an alternative 
    sudo update-alternatives --remove libblas.so /usr/lib/x86_64-linux-gnu/blas/libblas.so

    # use libblas.so
    g++ pardiso_sym.cpp -o pardiso_sym -L/usr/local/lib -lpardiso600-GNU720-X86-64 -L/usr/lib -lblas -llapack -lgfortran -fopenmp -lpthread -lm
```
