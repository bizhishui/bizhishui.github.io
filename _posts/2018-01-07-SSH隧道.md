---
title: SSH隧道
layout: post
guid: urn:uuid:9a7d982b-bd5e-47a0-8883-5596cf148e86
summary: SSH会自动加密和解密所有SSH客户端与服务端之间的网络数据。但是，SSH还同时提供了一个非常有用的功能，这就是端口转发。它能够将其他TCP端口的网络数据通过SSH链接来转发，并且自动提供了相应的加密及解密服务，这一过程有时也被叫做“隧道”（tunneling）。
categories:
  - linux
tags:
  - SSH
  - Tunneling
---

> 偶然看到利用SSH隧道技术翻墙的博文，相比熟知的VPN，它免费而且容易建立。受限于条件，并未完全实验，只是觉得有意思mark一下。
> 主要参考[pchou](http://www.pchou.info/linux/2015/11/01/ssh-tunnel.html)和[IBM开发者文章](https://www.ibm.com/developerworks/cn/linux/l-cn-sshforward/)。

SSH的两大功能：

1. 加密SSH Client端至SSH Server端之间的通讯数据
2. 突破防火墙的限制完成一些之前无法建立的[TCP](https://en.wikipedia.org/wiki/Transmission_Control_Protocol)连接

第一点很常用（比如Git），本文主要针对第后者。

### 端口转发

SSH 会自动加密和解密所有SSH客户端与服务端之间的网络数据。但是，SSH还同时提供了一个非常有用的功能，这就是端口转发。它能够将其他TCP端口的网络数据通过SSH链接来转发，
并且自动提供了相应的加密及解密服务。这一过程有时也被叫做“隧道”（tunneling），这是因为SSH为其他TCP链接提供了一个安全的通道来进行传输而得名。例如，Telnet，SMTP，LDAP 这些 
TCP应用均能够从中得益，避免了用户名，密码以及隐私信息的明文传输。而与此同时，如果您工作环境中的防火墙限制了一些网络端口的使用，但是允许SSH的连接，那么也是能够通过将TCP 
端口转发来使用SSH进行通讯。使用端口转发之后，TCP端口可以不直接通讯，而是分别转发到SSH客服端和服务端来通讯，从而自动实现了数据加密同时*绕过了防火墙的限制*。


### 动态转发

端口转发有本地转发、远程转发和动态转发等常见的几种。相对来说，动态转发可以实现SOCKS代理从而加密以及突破防火墙对Web浏览的限制。
其命令为：
```
    ssh -D <local port> <SSH Server>
    ssh -D 7001 username@remote-host      # 7001端口作为本地SOCKS的监听端口，1024~65535空闲端口均可
```


### WEB浏览器SOCKS代理设置
